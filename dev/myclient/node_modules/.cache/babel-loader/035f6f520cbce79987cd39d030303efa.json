{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\LeoLu\\\\Desktop\\\\NYT_Guardian_News_Web\\\\dev\\\\myclient\\\\src\\\\routers\\\\Search.js\";\nimport React from 'react';\nimport Navbar from 'react-bootstrap/Navbar';\nimport Nav from 'react-bootstrap/Nav';\nimport { FaRegBookmark } from \"react-icons/fa\";\nimport AsyncSelect from 'react-select/lib/Async';\nimport '../css/Home.css';\nimport { css } from \"@emotion/core\";\nimport BounceLoader from \"react-spinners/BounceLoader\";\nimport MiniNewsCard from '../components/MiniNewsCard';\nimport PropTypes from 'prop-types';\nimport { NavLink } from \"react-router-dom\";\nimport { withRouter } from 'react-router-dom';\nimport ReactTooltip from 'react-tooltip';\nconst override = css`\n  margin-left: auto;\n  margin-right: auto;\n  margin-top: 20%;\n  display: block;\n`;\n\nclass Search extends React.Component {\n  constructor(props) {\n    super(props);\n    let query = window.location.search.substring(3);\n    let news = \"Guardian\";\n\n    if (window.localStorage.checking) {\n      if (window.localStorage.checking === 'false') {\n        news = \"NYTimes\";\n      }\n    }\n\n    let option = {\n      label: decodeURI(query),\n      option: decodeURI(query)\n    };\n    this.state = {\n      keyWord: query,\n      selectedOption: option,\n      results: [],\n      newsPaper: news,\n      loading: true\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.loadoptions = this.loadoptions.bind(this);\n  }\n\n  componentDidMount() {\n    let keyword = encodeURI(this.state.keyWord);\n    document.getElementsByClassName(\"loading\")[0].style.display = '';\n    let news = this.state.newsPaper;\n    let url = \"api/search?keyword=\" + keyword + \"&news=\" + news;\n    fetch(url, {\n      mode: 'cors'\n    }).then(response => {\n      return response.json();\n    }).then(res => {\n      if (this.state.newsPaper === 'NYTimes') {\n        this.setState({\n          results: res.response.docs,\n          loading: false\n        });\n      } else {\n        this.setState({\n          results: res.response.results,\n          loading: false\n        });\n      }\n\n      document.getElementsByClassName(\"loading\")[0].style.display = 'none';\n    });\n  }\n\n  handleChange(value) {\n    let query = value.value;\n    let id = \"Guardian\";\n\n    if (window.localStorage.checking && window.localStorage.checking === 'false') {\n      id = \"NYTimes\";\n    }\n\n    this.setState({\n      selectedOption: value,\n      keyWord: query\n    }, () => {\n      this.props.history.push('/search?q=' + encodeURI(query));\n    });\n  }\n\n  loadoptions(inputValue, callback) {\n    if (!inputValue) {\n      callback([]);\n    } else {\n      let url = \"https://leo1.cognitiveservices.azure.com/bing/v7.0/suggestions?q=\" + inputValue;\n      fetch(url, {\n        headers: {\n          \"Ocp-Apim-Subscription-Key\": \"bb7176baabd945aaacabb06e566313ce\"\n        }\n      }).then(function (response) {\n        return response.json();\n      }).then(json => {\n        let result = [];\n\n        if (json.suggestionGroups) {\n          for (let suggestion of json.suggestionGroups[0].searchSuggestions) {\n            let temp = new Object();\n            temp.label = suggestion.displayText;\n            temp.value = suggestion.query;\n            result.push(temp);\n          }\n        }\n\n        callback(result);\n      }).catch(error => {\n        alert(error);\n      });\n    }\n  }\n\n  render() {\n    let article_cards = [];\n    let num = 0;\n    this.state.results.forEach(result => {\n      let data = new Object();\n      data.num = num;\n\n      if (this.state.newsPaper === \"NYTimes\") {\n        data.type = \"NYTimes\";\n        data.defaultImg = \"https://upload.wikimedia.org/wikipedia/commons/0/0e/Nytimes_hq.jpg\";\n        if (!result.news_desk) return true;\n        if (!result.headline) return true;\n        if (!result.headline.main) return true;\n        if (!result.abstract) return true;\n        if (!result.web_url) return true;\n        if (!result.pub_date) return true;\n        if (!result.multimedia) return true;\n        data.section = result.news_desk;\n        data.title = result.headline.main;\n        data.abstract = result.abstract;\n        data.articleURL = result.web_url;\n        data.id = \"\";\n        data.date = result.pub_date.substring(0, 10);\n\n        for (let img of result.multimedia) {\n          if (img.width >= 2000) {\n            data.defaultImg = \"https://www.nytimes.com/\" + img.url;\n            break;\n          }\n        }\n\n        if (num < 10) {\n          let card = /*#__PURE__*/React.createElement(MiniNewsCard, {\n            data: data,\n            key: num,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 144,\n              columnNumber: 22\n            }\n          });\n          article_cards.push(card);\n        }\n      } else {\n        data.type = \"Guardian\";\n        if (!result.id) return true;\n        if (!result.sectionId) return true;\n        if (!result.webTitle) return true;\n        if (!result.blocks) return true;\n        if (!result.blocks.body) return true;\n        if (!result.blocks.body[0]) return true;\n        if (!result.blocks.body[0].bodyTextSummary) return true;\n        if (!result.webUrl) return true;\n        if (!result.webPublicationDate) return true;\n        if (!result.blocks.main) return true;\n        if (!result.blocks.main.elements) return true;\n        if (!result.blocks.main.elements[0]) return true;\n        if (!result.blocks.main.elements[0].assets) return true;\n        data.id = result.id;\n        data.defaultImg = \"https://assets.guim.co.uk/images/eada8aa27c12fe2d5afa3a89d3fbae0d/fallback-logo.png\";\n        data.section = result.sectionId;\n        data.title = result.webTitle;\n        data.abstract = result.blocks.body[0].bodyTextSummary;\n        data.articleURL = result.webUrl;\n        data.date = result.webPublicationDate.substring(0, 10);\n        let assets = result.blocks.main.elements[0].assets;\n\n        if (assets.length !== 0) {\n          if (assets[assets.length - 1].file) {\n            data.defaultImg = assets[assets.length - 1].file;\n          }\n        }\n\n        if (num < 10) {\n          let card = /*#__PURE__*/React.createElement(MiniNewsCard, {\n            data: data,\n            key: num,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 193,\n              columnNumber: 22\n            }\n          });\n          article_cards.push(card);\n        }\n      }\n\n      num += 1;\n    });\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"main\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 4\n      }\n    }, /*#__PURE__*/React.createElement(Navbar, {\n      collapseOnSelect: true,\n      expand: \"lg\",\n      bg: \"dark\",\n      variant: \"dark\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"select-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(AsyncSelect, {\n      placeholder: \"Enter keyword ..\",\n      loadOptions: this.loadoptions,\n      onChange: this.handleChange,\n      value: this.state.selectedOption,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(Navbar.Toggle, {\n      \"aria-controls\": \"responsive-navbar-nav\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(Navbar.Collapse, {\n      id: \"responsive-navbar-nav\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Nav, {\n      className: \"mr-auto\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Nav.Link, {\n      as: NavLink,\n      to: \"/\",\n      href: \"/\",\n      activeClassName: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 11\n      }\n    }, \"Home\"), /*#__PURE__*/React.createElement(Nav.Link, {\n      as: NavLink,\n      to: \"/world\",\n      href: \"/world\",\n      activeClassName: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 11\n      }\n    }, \"World\"), /*#__PURE__*/React.createElement(Nav.Link, {\n      as: NavLink,\n      to: \"/politics\",\n      href: \"/politics\",\n      activeClassName: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 11\n      }\n    }, \"Politics\"), /*#__PURE__*/React.createElement(Nav.Link, {\n      as: NavLink,\n      to: \"/business\",\n      href: \"/business\",\n      activeClassName: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 11\n      }\n    }, \"Business\"), /*#__PURE__*/React.createElement(Nav.Link, {\n      as: NavLink,\n      to: \"/technology\",\n      href: \"/technology\",\n      activeClassName: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 11\n      }\n    }, \"Technology\"), /*#__PURE__*/React.createElement(Nav.Link, {\n      as: NavLink,\n      to: \"/sports\",\n      href: \"/sports\",\n      activeClassName: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 11\n      }\n    }, \"Sports\")), /*#__PURE__*/React.createElement(Nav, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Nav.Link, {\n      as: NavLink,\n      to: \"/favorites\",\n      href: \"/favorites\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(FaRegBookmark, {\n      \"data-tip\": \"Bookmark\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 68\n      }\n    }))))), /*#__PURE__*/React.createElement(\"h3\", {\n      id: \"results\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 7\n      }\n    }, \"Results\"), /*#__PURE__*/React.createElement(BounceLoader, {\n      size: 40,\n      css: override,\n      loading: this.state.loading,\n      color: \"#3E7BBA\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 7\n      }\n    }), /*#__PURE__*/React.createElement(\"h4\", {\n      className: \"loading\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"b\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 9\n      }\n    }, \"Loading\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"result-articles\",\n      id: \"result-articles\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 7\n      }\n    }, article_cards), /*#__PURE__*/React.createElement(ReactTooltip, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 7\n      }\n    }));\n  }\n\n}\n\nSearch.propTypes = {\n  newsPaper: PropTypes.string\n};\nexport default withRouter(Search);","map":{"version":3,"sources":["C:/Users/LeoLu/Desktop/NYT_Guardian_News_Web/dev/myclient/src/routers/Search.js"],"names":["React","Navbar","Nav","FaRegBookmark","AsyncSelect","css","BounceLoader","MiniNewsCard","PropTypes","NavLink","withRouter","ReactTooltip","override","Search","Component","constructor","props","query","window","location","search","substring","news","localStorage","checking","option","label","decodeURI","state","keyWord","selectedOption","results","newsPaper","loading","handleChange","bind","loadoptions","componentDidMount","keyword","encodeURI","document","getElementsByClassName","style","display","url","fetch","mode","then","response","json","res","setState","docs","value","id","history","push","inputValue","callback","headers","result","suggestionGroups","suggestion","searchSuggestions","temp","Object","displayText","catch","error","alert","render","article_cards","num","forEach","data","type","defaultImg","news_desk","headline","main","abstract","web_url","pub_date","multimedia","section","title","articleURL","date","img","width","card","sectionId","webTitle","blocks","body","bodyTextSummary","webUrl","webPublicationDate","elements","assets","length","file","propTypes","string"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport Navbar from 'react-bootstrap/Navbar';\r\nimport Nav from 'react-bootstrap/Nav';\r\nimport { FaRegBookmark } from \"react-icons/fa\";\r\nimport AsyncSelect from 'react-select/lib/Async';\r\nimport '../css/Home.css';\r\nimport { css } from \"@emotion/core\";\r\nimport BounceLoader from \"react-spinners/BounceLoader\";\r\nimport MiniNewsCard from '../components/MiniNewsCard';\r\nimport PropTypes from 'prop-types';\r\nimport {NavLink} from \"react-router-dom\";\r\nimport { withRouter } from 'react-router-dom';\r\nimport ReactTooltip from 'react-tooltip';\r\n\r\nconst override = css`\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  margin-top: 20%;\r\n  display: block;\r\n`;\r\n\r\nclass Search extends React.Component{\r\n  constructor(props){\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tlet query = window.location.search.substring(3,);\r\n    let news = \"Guardian\";\r\n    if(window.localStorage.checking){\r\n      if(window.localStorage.checking === 'false'){\r\n        news = \"NYTimes\";\r\n      }\r\n    }\r\n\t\tlet option = {label: decodeURI(query), option: decodeURI(query)};\r\n\t\tthis.state = {keyWord: query, selectedOption: option, results:[], newsPaper: news, loading: true};\r\n\t\tthis.handleChange = this.handleChange.bind(this);\r\n\t\tthis.loadoptions = this.loadoptions.bind(this);\r\n\t}\r\n\t\r\n\tcomponentDidMount(){\r\n    let keyword = encodeURI(this.state.keyWord);\r\n    document.getElementsByClassName(\"loading\")[0].style.display = '';\r\n\t\tlet news = this.state.newsPaper;\r\n\t\tlet url = \"api/search?keyword=\" + keyword + \"&news=\" + news;\r\n\t\tfetch(url, {mode: 'cors'}).then(\r\n\t\t\t(response) => {\r\n\t\t\t\treturn response.json();\r\n\t\t\t}\r\n\t\t).then(\r\n\t\t\t(res) => {\r\n\t\t\t\tif(this.state.newsPaper === 'NYTimes'){\r\n          this.setState({results: res.response.docs,loading:false,});\r\n          \r\n        }\r\n        else{\r\n          this.setState({results: res.response.results,loading:false,});\r\n        }\r\n        document.getElementsByClassName(\"loading\")[0].style.display = 'none';\r\n\t\t\t}\r\n\t\t)\r\n\t}\r\n\t\r\n\thandleChange(value){\r\n    let query = value.value;\r\n    let id = \"Guardian\";\r\n    if(window.localStorage.checking && window.localStorage.checking === 'false'){\r\n      id = \"NYTimes\";\r\n\t\t}\r\n\t\tthis.setState({selectedOption: value, keyWord: query}, ()=>{\r\n      this.props.history.push('/search?q=' + encodeURI(query));\r\n    });\r\n      \r\n\t}\r\n\r\n\tloadoptions(inputValue, callback){\r\n    if(!inputValue){\r\n      callback([]);\r\n    }\r\n    else{\r\n      \r\n      let url = \"https://leo1.cognitiveservices.azure.com/bing/v7.0/suggestions?q=\" + inputValue;\r\n      fetch(url, {headers: {\"Ocp-Apim-Subscription-Key\": \"bb7176baabd945aaacabb06e566313ce\"}}).then(\r\n        function(response){\r\n          return response.json();\r\n        }\r\n      ).then(\r\n        (json) => {\r\n        \r\n          let result = [];\r\n          if(json.suggestionGroups){\r\n            for(let suggestion of json.suggestionGroups[0].searchSuggestions){\r\n              let temp = new Object();\r\n              temp.label = suggestion.displayText;\r\n              temp.value = suggestion.query;\r\n              result.push(temp);\r\n            }\r\n          }\r\n          callback(result);\r\n      }).catch(\r\n        (error) => {\r\n          alert(error);\r\n        }\r\n      );\r\n    }\r\n    \r\n\t};\r\n\t\r\n\trender(){\r\n\t\tlet article_cards = [];\r\n    let num = 0;\r\n    \r\n    this.state.results.forEach((result) => {\r\n      let data = new Object();\r\n      data.num = num;\r\n      if(this.state.newsPaper === \"NYTimes\"){\r\n        data.type = \"NYTimes\";\r\n        data.defaultImg = \"https://upload.wikimedia.org/wikipedia/commons/0/0e/Nytimes_hq.jpg\";\r\n        if(!result.news_desk)\r\n          return true;\r\n        if(!result.headline)\r\n          return true;\r\n        if(!result.headline.main)\r\n          return true;\r\n        if(!result.abstract)\r\n          return true;\r\n        if(!result.web_url)\r\n          return true;\r\n        if(!result.pub_date)\r\n          return true;\r\n        if(!result.multimedia)\r\n          return true;\r\n        data.section = result.news_desk;\r\n        data.title = result.headline.main;\r\n        data.abstract = result.abstract;\r\n        data.articleURL = result.web_url;\r\n        data.id = \"\";\r\n        data.date = result.pub_date.substring(0, 10);\r\n        for(let img of result.multimedia){\r\n          if(img.width >= 2000){\r\n            data.defaultImg = \"https://www.nytimes.com/\" + img.url;\r\n            break;\r\n          }\r\n        }\r\n        if(num < 10){\r\n          let card = <MiniNewsCard data={data} key={num}/>;\r\n          article_cards.push(card);\r\n        }\r\n        \r\n      }\r\n        \r\n      else{\r\n        data.type = \"Guardian\";\r\n        if(!result.id)\r\n          return true;\r\n        if(!result.sectionId)\r\n          return true;\r\n        if(!result.webTitle)\r\n          return true;\r\n        if(!result.blocks)\r\n          return true;\r\n        if(!result.blocks.body)\r\n          return true;\r\n        if(!result.blocks.body[0])\r\n          return true;\r\n        if(!result.blocks.body[0].bodyTextSummary)\r\n          return true;\r\n        if(!result.webUrl)\r\n          return true;\r\n        if(!result.webPublicationDate)\r\n          return true;\r\n        if(!result.blocks.main)\r\n          return true;\r\n        if(!result.blocks.main.elements)\r\n          return true;\r\n        if(!result.blocks.main.elements[0])\r\n          return true;\r\n        if(!result.blocks.main.elements[0].assets)\r\n          return true;\r\n        data.id = result.id;\r\n        data.defaultImg = \"https://assets.guim.co.uk/images/eada8aa27c12fe2d5afa3a89d3fbae0d/fallback-logo.png\";\r\n        data.section = result.sectionId;\r\n        data.title = result.webTitle;\r\n        data.abstract = result.blocks.body[0].bodyTextSummary;\r\n        data.articleURL = result.webUrl;\r\n        data.date = result.webPublicationDate.substring(0, 10);\r\n        let assets = result.blocks.main.elements[0].assets;\r\n        \r\n        if(assets.length !== 0){\r\n          if(assets[assets.length-1].file){\r\n            data.defaultImg = assets[assets.length-1].file;\r\n          }\r\n        }\r\n        if(num < 10){\r\n          let card = <MiniNewsCard data={data} key={num}/>;\r\n          article_cards.push(card);\r\n        }\r\n      }\r\n      num += 1;\r\n      \r\n\r\n    });\r\n\t\treturn(\r\n\t\t\t<div className='main'>\r\n        \r\n      <Navbar collapseOnSelect expand=\"lg\" bg=\"dark\" variant=\"dark\">\r\n        \r\n        <div className='select-container'>\r\n          <AsyncSelect \r\n            \r\n            placeholder = 'Enter keyword ..'\r\n            loadOptions = {this.loadoptions}\r\n            onChange = {this.handleChange}\r\n            value = {this.state.selectedOption}\r\n          />\r\n        </div>\r\n        \r\n        <Navbar.Toggle aria-controls=\"responsive-navbar-nav\" />\r\n        <Navbar.Collapse id=\"responsive-navbar-nav\">\r\n        <Nav className=\"mr-auto\">\r\n          <Nav.Link as={NavLink} to=\"/\" href=\"/\" activeClassName=''>Home</Nav.Link>\r\n          <Nav.Link as={NavLink} to=\"/world\" href=\"/world\" activeClassName=''>World</Nav.Link>\r\n          <Nav.Link as={NavLink} to=\"/politics\" href=\"/politics\" activeClassName=''>Politics</Nav.Link>\r\n          <Nav.Link as={NavLink} to=\"/business\" href=\"/business\" activeClassName=''>Business</Nav.Link>\r\n          <Nav.Link as={NavLink} to=\"/technology\" href=\"/technology\" activeClassName=''>Technology</Nav.Link>\r\n          <Nav.Link as={NavLink} to=\"/sports\" href=\"/sports\" activeClassName=''>Sports</Nav.Link>\r\n          \r\n        </Nav>\r\n        <Nav>\r\n          <Nav.Link as={NavLink} to=\"/favorites\" href=\"/favorites\"><FaRegBookmark data-tip=\"Bookmark\"/></Nav.Link>\r\n        </Nav>\r\n      </Navbar.Collapse>\r\n      </Navbar>\r\n      \r\n      \r\n      <h3 id='results'>Results</h3>\r\n      <BounceLoader\r\n        size={40}\r\n        css={override}\r\n        loading={this.state.loading}\r\n        color={\"#3E7BBA\"}\r\n      />\r\n      <h4 className='loading'>\r\n        <b>Loading</b>\r\n      </h4>\r\n      <div className='result-articles' id='result-articles'>\r\n\t\t\t\t\r\n\t\t\t\t{article_cards}\r\n      </div>\r\n      <ReactTooltip/>\r\n      </div>\r\n\t\t);\r\n\t}\r\n}\r\nSearch.propTypes = {\r\n\tnewsPaper: PropTypes.string,\r\n}\r\n\r\nexport default withRouter(Search);"]},"metadata":{},"sourceType":"module"}